# VaultsRegistry (contract)

When you deploy the **StakeWise** `v3-core` contracts, you get messages like these:

```
VaultsRegistry deployed at 0x????????????????????????????????????????
Added EthVaultFactory to VaultsRegistry
Added EthVault implementation to VaultsRegistry
Added EthPrivVaultFactory to VaultsRegistry
Added EthPrivVault implementation to VaultsRegistry
Added EthBlocklistVaultFactory to VaultsRegistry
Added EthBlocklistVault implementation to VaultsRegistry
Added EthBlocklistVault implementation to VaultsRegistry
Added EthErc20Vault implementation to VaultsRegistry
Added EthPrivErc20VaultFactory to VaultsRegistry
Added EthPrivErc20Vault implementation to VaultsRegistry
Added EthBlocklistErc20VaultFactory to VaultsRegistry
Added EthBlocklistErc20Vault implementation to VaultsRegistry
Added EthGenesisVault to VaultsRegistry
Added EthGenesisVault implementation to VaultsRegistry
Added EthFoxVault to VaultsRegistry
Added EthRestakeVaultFactory to VaultsRegistry
Added EthRestakePrivVaultFactory to VaultsRegistry
Added EthRestakeBlocklistVaultFactory to VaultsRegistry
Added EthRestakeErc20VaultFactory to VaultsRegistry
Added EthRestakePrivErc20VaultFactory to VaultsRegistry
Added EthRestakeBlocklistErc20VaultFactory to VaultsRegistry
VaultsRegistry ownership transferred to 0x????????????????????????????????????????                                                                                                
```

One thing that this suggests is that `VaultsRegistry` is holding references to the various **factories** for creating **vaults**.

Within the `VaultsRegistry` source-code, we see the public variables:

```solidity
mapping(address => bool) public override factories;
```

[IVaultsRegistry](../../contracts/interfaces/IVaultsRegistry.sol.md) definition for this is:

```solidity
/**
 * @notice Registered Factories
 * @param factory The address of the factory to check whether it is whitelisted
 * @return `true` for the whitelisted Factory, `false` otherwise
 */
function factories(address factory) external view returns (bool);
```

`VaultsRegistry`'s `addVault()` function looks like this:

```solidity
function addVault(address vault) external override {
  if (!factories[msg.sender] && msg.sender != owner()) revert Errors.AccessDenied();

  vaults[vault] = true;
  emit VaultAdded(msg.sender, vault);
}
```

Also, `VaultsRegistry`'s `addVault()` function looks like this:

```solidity
function addFactory(address factory) external override onlyOwner {
  if (factories[factory]) revert Errors.AlreadyAdded();
  factories[factory] = true;
  emit FactoryAdded(factory);
}
```

This suggests that `VaultsRegistry` is just storing the address of the **factories** to make sure that only a **factory** can add a vault to `VaultsRegistry`.

AND THAT THIS IS **NOT** THE PLACE YOU GO TO TO FIND THE FACTORIES.

The address of the factories is outputted from the deploy script â€” although the message is a bit misleading.

You will see quadruplets like these:

```
EthVault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthVaultFactory to VaultsRegistry
Added EthVault implementation to VaultsRegistry
```

```
EthPrivVault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthPrivVaultFactory to VaultsRegistry
Added EthPrivVault implementation to VaultsRegistry
```

```
EthBlocklistVault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthBlocklistVaultFactory to VaultsRegistry
Added EthBlocklistVault implementation to VaultsRegistry
```

```
EthErc20Vault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthErc20VaultFactory to VaultsRegistry
Added EthErc20Vault implementation to VaultsRegistry
```

```
EthPrivErc20Vault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthPrivErc20VaultFactory to VaultsRegistry
Added EthPrivErc20Vault implementation to VaultsRegistry
```

```
EthBlocklistErc20Vault deployed at 0x????????????????????????????????????????
EthVaultFactory deployed at 0x????????????????????????????????????????
Added EthBlocklistErc20VaultFactory to VaultsRegistry
Added EthBlocklistErc20Vault implementation to VaultsRegistry
```

## Is

VaultsRegistry is:

* Ownable2Step ([openzeppelin](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol))
* [IVaultsRegistry](../../contracts/interfaces/IVaultsRegistry.sol.md)
